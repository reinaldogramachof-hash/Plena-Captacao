<!DOCTYPE html>
<html lang="pt-BR" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plena Capta√ß√£o v1.0 - Sistema Inteligente</title>
    <meta name="description" content="Sistema inteligente de prospec√ß√£o com IA integrada para a Plena Inform√°tica">
    <meta name="theme-color" content="#000000">

    <!-- CSS principal -->
    <link rel="stylesheet" href="assets/css/main.css">

    <!-- Font Awesome -->
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon"
          href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üéØ</text></svg>">
</head>

<body>
<div class="app-container">
    <!-- ========== SIDEBAR ========== -->
    <nav class="sidebar">
        <div class="logo">
            <h1>Plena Capta√ß√£o</h1>
            <p class="version">v1.0</p>
        </div>

        <ul class="nav-menu">
            <li class="nav-item active" data-section="dashboard">
                <i class="fas fa-chart-network"></i>
                <span>Dashboard Overview</span>
            </li>
            <li class="nav-item" data-section="leads">
                <i class="fas fa-users"></i>
                <span>Gest√£o de Leads</span>
            </li>
            <li class="nav-item" data-section="strategies">
                <i class="fas fa-chess-knight"></i>
                <span>Estrat√©gias IA</span>
            </li>
            <li class="nav-item" data-section="reports">
                <i class="fas fa-chart-bar"></i>
                <span>Relat√≥rios Avan√ßados</span>
            </li>
            <li class="nav-item" data-section="alerts">
                <i class="fas fa-bell"></i>
                <span>Alertas</span>
                <span class="notification-badge" id="sidebarAlerts">0</span>
            </li>
        </ul>

        <div class="theme-toggle-container">
            <button class="theme-toggle" id="themeToggle">
                <span>üåô</span>
                <span>Modo Claro</span>
            </button>
        </div>
    </nav>

    <!-- ========== √ÅREA PRINCIPAL ========== -->
    <main class="main-content">

        <!-- ===== HEADER FIXO NO TOPO ===== -->
        <header class="header">
            <!-- busca -->
            <div class="search-bar">
                <i class="fas fa-search"></i>
                <input type="text" id="searchInput"
                       placeholder="Buscar leads, estrat√©gias, relat√≥rios...">
            </div>

            <!-- a√ß√µes -->
            <div class="header-actions">
                <button class="btn btn-primary" onclick="openAddLeadModal()">
                    <i class="fas fa-plus"></i>
                    <span>Novo Lead</span>
                </button>

                <button class="btn btn-secondary" onclick="runIAProspecting()">
                    <i class="fas fa-robot"></i>
                    <span>IA Prospec√ß√£o</span>
                </button>

                <div class="notification-wrapper">
                    <button class="notification-btn" id="notificationBtn">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge" id="headerAlerts">0</span>
                    </button>

                    <div class="notification-dropdown" id="notificationDropdown">
                        <div class="notification-header">
                            <h4>Central de Notifica√ß√µes</h4>
                            <button onclick="markAllAsRead()">Limpar todas</button>
                        </div>

                        <div class="notification-list" id="notificationList">
                            <!-- preenchido via JS -->
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- ===== CONTE√öDO SCROLL√ÅVEL ===== -->
        <div class="content-area">

            <!-- ================= DASHBOARD ================= -->
            <section id="dashboard" class="section active">
                <div class="section-header">
                    <h1>Dashboard Overview</h1>
                    <p>Vis√£o completa do seu pipeline de prospec√ß√£o em S√£o Jos√© dos Campos</p>
                    <div class="dashboard-time" id="dashboardTime"></div>
                </div>

                <!-- M√©tricas principais -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-bullseye"></i></div>
                        <div class="stat-info">
                            <h3 id="totalLeads">0</h3>
                            <p>Leads Ativos</p>
                        </div>
                        <div class="stat-trend up">
                            <i class="fas fa-arrow-up"></i>
                            12%
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-fire"></i></div>
                        <div class="stat-info">
                            <h3 id="criticalLeads">0</h3>
                            <p>Leads Cr√≠ticos</p>
                        </div>
                        <div class="stat-trend up">
                            <i class="fas fa-arrow-up"></i>
                            8%
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-rocket"></i></div>
                        <div class="stat-info">
                            <h3 id="conversionRate">0%</h3>
                            <p>Taxa de Convers√£o</p>
                        </div>
                        <div class="stat-trend up">
                            <i class="fas fa-arrow-up"></i>
                            5%
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-clock"></i></div>
                        <div class="stat-info">
                            <h3 id="pendingActions">0</h3>
                            <p>A√ß√µes Pendentes</p>
                        </div>
                        <div class="stat-trend down">
                            <i class="fas fa-arrow-down"></i>
                            3%
                        </div>
                    </div>
                </div>

                <!-- Gr√°ficos e Recomenda√ß√µes IA -->
                <div class="dashboard-content">
                    <!-- gr√°ficos -->
                    <div class="charts-container">
                        <div class="chart-card">
                            <h3><i class="fas fa-chart-pie"></i> Distribui√ß√£o por Potencial</h3>
                            <canvas id="potentialChart" height="250"></canvas>
                        </div>

                        <div class="chart-card">
                            <h3><i class="fas fa-tags"></i> Leads por Nicho</h3>
                            <canvas id="nicheChart" height="250"></canvas>
                        </div>

                        <div class="chart-card">
                            <h3><i class="fas fa-chart-line"></i> Atividade Semanal</h3>
                            <canvas id="activityChart" height="250"></canvas>
                        </div>

                        <div class="chart-card">
                            <h3><i class="fas fa-trending-up"></i> Performance de Convers√£o</h3>
                            <canvas id="conversionChart" height="250"></canvas>
                        </div>
                    </div>

                    <!-- bloco IA -->
                    <div class="ai-recommendations">
                        <div class="ai-header">
                            <i class="fas fa-robot"></i>
                            <h3>Recomenda√ß√µes da IA</h3>
                            <button class="btn btn-sm" onclick="showAIRecommendations()" title="Atualizar recomenda√ß√µes">
                                <i class="fas fa-sync-alt"></i>
                            </button>
                        </div>

                        <div class="recommendations-grid" id="aiRecommendations">
                            <!-- preenchido via JS -->
                        </div>
                    </div>
                </div>

                <!-- a√ß√µes r√°pidas -->
                <div class="quick-actions">
                    <h3><i class="fas fa-bolt"></i> A√ß√µes R√°pidas</h3>

                    <div class="actions-grid">
                        <button class="action-card"
                                onclick="plenaSystem.filterLeads('critical')">
                            <i class="fas fa-fire"></i>
                            <span>Ver Leads Cr√≠ticos</span>
                        </button>

                        <button class="action-card"
                                onclick="runIAProspecting()">
                            <i class="fas fa-search-plus"></i>
                            <span>Nova Busca IA</span>
                        </button>

                        <button class="action-card"
                                onclick="showTodaysStrategy()">
                            <i class="fas fa-chess-knight"></i>
                            <span>Estrat√©gia do Dia</span>
                        </button>

                        <button class="action-card"
                                onclick="generateQuickReport()">
                            <i class="fas fa-file-alt"></i>
                            <span>Relat√≥rio R√°pido</span>
                        </button>

                        <button class="action-card"
                                onclick="iaAssistant.showScriptTemplates()">
                            <i class="fas fa-scroll"></i>
                            <span>Scripts de Liga√ß√£o</span>
                        </button>

                        <button class="action-card"
                                onclick="testNotificationSystem()">
                            <i class="fas fa-bell"></i>
                            <span>Testar Notifica√ß√£o</span>
                        </button>
                    </div>
                </div>
            </section>

            <!-- ================= LEADS ================= -->
            <section id="leads" class="section">
                <div class="section-header">
                    <h2>Gest√£o de Leads</h2>
                    <p>Gerencie todos os seus potenciais clientes em S√£o Jos√© dos Campos</p>

                    <div class="leads-stats">
                        <div class="stat-mini">
                            <span class="stat-number" id="leadsTotal">0</span>
                            <span class="stat-label">Total</span>
                        </div>
                        <div class="stat-mini">
                            <span class="stat-number" id="leadsContacted">0</span>
                            <span class="stat-label">Contactados</span>
                        </div>
                        <div class="stat-mini">
                            <span class="stat-number" id="leadsNeverContacted">0</span>
                            <span class="stat-label">N√£o Contactados</span>
                        </div>
                    </div>

                    <div class="filters">
                        <button class="filter-btn active" data-filter="all">Todos</button>
                        <button class="filter-btn" data-filter="critical">Cr√≠ticos</button>
                        <button class="filter-btn" data-filter="high">Alto Potencial</button>
                        <button class="filter-btn" data-filter="never-contacted">N√£o Contactados</button>
                        <button class="filter-btn" data-filter="recent">Recentes</button>
                    </div>
                </div>

                <div class="leads-grid" id="leadsContainer">
                    <!-- cards de leads via JS -->
                </div>
            </section>

            <!-- ================= ESTRAT√âGIAS ================= -->
            <section id="strategies" class="section">
                <div class="section-header">
                    <h2>Estrat√©gias de Prospec√ß√£o IA</h2>
                    <p>Scripts e estrat√©gias inteligentes por nicho de atua√ß√£o</p>
                </div>

                <div class="ai-recommendations">
                    <div class="ai-header">
                        <i class="fas fa-robot"></i>
                        <h3>Estrat√©gias por Nicho - S√£o Jos√© dos Campos</h3>
                        <button class="btn btn-sm" onclick="iaAssistant.generatePerformanceReport()">
                            <i class="fas fa-chart-bar"></i> Relat√≥rio
                        </button>
                    </div>

                    <div class="recommendations-grid">
                        <div class="recommendation-card">
                            <h4>üë®‚Äç‚öïÔ∏è Profissionais Liberais</h4>
                            <p><strong>Abordagem:</strong> "Analisei que profissionais da sua √°rea com presen√ßa digital conseguem at√© 40% mais agendamentos. Posso mostrar como aplicar isso no seu consult√≥rio?"</p>
                            <p><strong>Argumento-chave:</strong> Agendamentos online 24h + Credibilidade digital</p>
                            <p><strong>Estat√≠stica:</strong> 42% de taxa de convers√£o comprovada</p>
                        </div>

                        <div class="recommendation-card">
                            <h4>üîß Servi√ßos Especializados</h4>
                            <p><strong>Abordagem:</strong> "Notamos que servi√ßos como o seu que aparecem no Google quando algu√©m busca 'emerg√™ncia' conseguem 3x mais clientes. Podemos colocar seu neg√≥cio nessa posi√ß√£o?"</p>
                            <p><strong>Argumento-chave:</strong> Visibilidade em emerg√™ncias + Agendamento simplificado</p>
                            <p><strong>Estat√≠stica:</strong> 38% de taxa de convers√£o</p>
                        </div>

                        <div class="recommendation-card">
                            <h4>üè™ Com√©rcio Local</h4>
                            <p><strong>Abordagem:</strong> "Seus produtos s√£o excelentes, mas voc√™ est√° perdendo as vendas do turno da noite e finais de semana. Com um e-commerce, sua loja ficaria aberta 24h."</p>
                            <p><strong>Argumento-chave:</strong> Vitrine 24h + Vendas fora do hor√°rio comercial</p>
                            <p><strong>Estat√≠stica:</strong> 35% de taxa de convers√£o</p>
                        </div>

                        <div class="recommendation-card">
                            <h4>üí™ Sa√∫de e Bem-estar</h4>
                            <p><strong>Abordagem:</strong> "Sua academia/cl√≠nica tem √≥tima estrutura! Mas muitos potenciais alunos buscam primeiro online. Podemos colocar seu neg√≥cio na frente desses buscadores?"</p>
                            <p><strong>Argumento-chave:</strong> Capta√ß√£o cont√≠nua + Agendamento online</p>
                            <p><strong>Estat√≠stica:</strong> 45% de taxa de convers√£o</p>
                        </div>
                    </div>
                </div>

                <div class="quick-actions">
                    <h3><i class="fas fa-tools"></i> Ferramentas de Apoio</h3>

                    <div class="actions-grid">
                        <button class="action-card"
                                onclick="iaAssistant.showScriptTemplates()">
                            <i class="fas fa-scroll"></i>
                            <span>Scripts de Liga√ß√£o</span>
                        </button>

                        <button class="action-card"
                                onclick="iaAssistant.showEmailTemplates()">
                            <i class="fas fa-envelope"></i>
                            <span>Templates de Email</span>
                        </button>

                        <button class="action-card"
                                onclick="iaAssistant.showObjectionHandling()">
                            <i class="fas fa-comments"></i>
                            <span>Tratativa de Obje√ß√µes</span>
                        </button>

                        <button class="action-card"
                                onclick="iaAssistant.showROICalculator()">
                            <i class="fas fa-calculator"></i>
                            <span>Calculadora de ROI</span>
                        </button>

                        <button class="action-card"
                                onclick="iaAssistant.exportIAData()">
                            <i class="fas fa-download"></i>
                            <span>Exportar Dados IA</span>
                        </button>

                        <button class="action-card"
                                style="border-color: var(--danger);"
                                onclick="iaAssistant.resetIAData()">
                            <i class="fas fa-redo"></i>
                            <span>Resetar IA</span>
                        </button>
                    </div>
                </div>
            </section>

            <!-- ================= RELAT√ìRIOS ================= -->
            <section id="reports" class="section">
                <div class="section-header">
                    <h2>Relat√≥rios Avan√ßados</h2>
                    <p>An√°lises detalhadas e m√©tricas de performance</p>

                    <div class="filters">
                        <button class="filter-btn active" data-report="overview">Vis√£o Geral</button>
                        <button class="filter-btn" data-report="performance">Desempenho</button>
                        <button class="filter-btn" data-report="conversion">Convers√£o</button>
                        <button class="filter-btn" data-report="niche">Por Nicho</button>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-chart-line"></i></div>
                        <div class="stat-info">
                            <h3 id="reportTotalLeads">0</h3>
                            <p>Total de Leads</p>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-target"></i></div>
                        <div class="stat-info">
                            <h3 id="reportConversion">0%</h3>
                            <p>Taxa de Convers√£o</p>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-clock"></i></div>
                        <div class="stat-info">
                            <h3 id="reportResponseTime">0h</h3>
                            <p>Tempo M√©dio de Resposta</p>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-money-bill-wave"></i></div>
                        <div class="stat-info">
                            <h3 id="reportPotential">R$ 0</h3>
                            <p>Potencial Financeiro</p>
                        </div>
                    </div>
                </div>

                <div class="charts-container">
                    <div class="chart-card">
                        <h3><i class="fas fa-chart-bar"></i> Evolu√ß√£o de Leads por M√™s</h3>
                        <canvas id="monthlyLeadsChart" height="250"></canvas>
                    </div>

                    <div class="chart-card">
                        <h3><i class="fas fa-tachometer-alt"></i> Desempenho por Nicho</h3>
                        <canvas id="performanceChart" height="250"></canvas>
                    </div>

                    <div class="chart-card">
                        <h3><i class="fas fa-funnel-dollar"></i> Funil de Convers√£o</h3>
                        <canvas id="funnelChart" height="250"></canvas>
                    </div>

                    <div class="chart-card">
                        <h3><i class="fas fa-calendar-alt"></i> Atividade por Per√≠odo</h3>
                        <canvas id="timelineChart" height="250"></canvas>
                    </div>
                </div>

                <div class="quick-actions">
                    <h3><i class="fas fa-download"></i> Exportar Relat√≥rios</h3>

                    <div class="actions-grid">
                        <button class="action-card"
                                onclick="generateQuickReport()">
                            <i class="fas fa-file-pdf"></i>
                            <span>Relat√≥rio PDF</span>
                        </button>

                        <button class="action-card"
                                onclick="exportLeadsData()">
                            <i class="fas fa-file-csv"></i>
                            <span>Dados em CSV</span>
                        </button>

                        <button class="action-card"
                                onclick="iaAssistant.exportIAData()">
                            <i class="fas fa-file-code"></i>
                            <span>Dados da IA</span>
                        </button>

                        <button class="action-card"
                                onclick="notificationSystem.exportNotifications()">
                            <i class="fas fa-bell"></i>
                            <span>Notifica√ß√µes</span>
                        </button>
                    </div>
                </div>
            </section>

            <!-- ================= ALERTAS ================= -->
            <section id="alerts" class="section">
                <div class="section-header">
                    <h2>Central de Alertas</h2>
                    <p>Notifica√ß√µes inteligentes e a√ß√µes pendentes</p>

                    <div class="filters">
                        <button class="filter-btn active" data-alert-type="all">Todos</button>
                        <button class="filter-btn" data-alert-type="urgent">Urgentes</button>
                        <button class="filter-btn" data-alert-type="reminder">Lembretes</button>
                        <button class="filter-btn" data-alert-type="success">Conclu√≠dos</button>
                    </div>
                </div>

                <div class="ai-recommendations">
                    <div class="ai-header">
                        <i class="fas fa-bell"></i>
                        <h3>Alertas Ativos</h3>

                        <div class="header-actions">
                            <button class="btn btn-sm"
                                    onclick="notificationSystem.cleanupOldNotifications()">
                                <i class="fas fa-trash"></i>
                                Limpar Antigos
                            </button>

                            <button class="btn btn-sm"
                                    onclick="notificationSystem.clearAllNotifications()">
                                <i class="fas fa-broom"></i>
                                Limpar Todos
                            </button>
                        </div>
                    </div>

                    <div id="alertsContainer">
                        <!-- alertas via JS -->
                    </div>
                </div>

                <div class="quick-actions">
                    <h3><i class="fas fa-cog"></i> Configura√ß√µes de Notifica√ß√£o</h3>

                    <div class="actions-grid">
                        <button class="action-card"
                                onclick="notificationSystem.checkPendingActions()">
                            <i class="fas fa-sync"></i>
                            <span>Verificar A√ß√µes Pendentes</span>
                        </button>

                        <button class="action-card"
                                onclick="markAllAsRead()">
                            <i class="fas fa-check-double"></i>
                            <span>Marcar Todas como Lidas</span>
                        </button>

                        <button class="action-card"
                                onclick="testNotificationSystem()">
                            <i class="fas fa-bell"></i>
                            <span>Testar Notifica√ß√£o</span>
                        </button>

                        <button class="action-card"
                                onclick="notificationSystem.addDailyGoalNotification()">
                            <i class="fas fa-bullseye"></i>
                            <span>Meta do Dia</span>
                        </button>

                        <button class="action-card"
                                onclick="notificationSystem.exportNotifications()">
                            <i class="fas fa-download"></i>
                            <span>Exportar Notifica√ß√µes</span>
                        </button>

                        <button class="action-card"
                                onclick="showNotification('Sistema','Notifica√ß√£o de teste do sistema','success')">
                            <i class="fas fa-check-circle"></i>
                            <span>Teste de Sucesso</span>
                        </button>
                    </div>
                </div>
            </section>

        </div> <!-- /content-area -->
    </main>
</div> <!-- /app-container -->


<!-- ========== MODAIS ========== -->

<!-- Modal: Novo Lead -->
<div class="modal" id="addLeadModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3><i class="fas fa-plus"></i> Cadastrar Novo Lead</h3>
            <button class="btn btn-outline"
                    onclick="closeModal('addLeadModal')"
                    style="color: white; border-color: white;">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <div class="modal-body">
            <div class="form-group">
                <label><i class="fas fa-building"></i> Nome do Estabelecimento *</label>
                <input type="text" class="form-control" id="newLeadName"
                       placeholder="Ex: Padaria S√£o Jos√©">
            </div>

            <div class="form-group">
                <label><i class="fas fa-tag"></i> Nicho *</label>
                <select class="form-control" id="newLeadNiche">
                    <option value="">Selecione um nicho</option>
                    <option value="Profissionais Liberais">üë®‚Äç‚öïÔ∏è Profissionais Liberais</option>
                    <option value="Servi√ßos Especializados">üîß Servi√ßos Especializados</option>
                    <option value="Com√©rcio Local">üè™ Com√©rcio Local</option>
                    <option value="Sa√∫de e Bem-estar">üí™ Sa√∫de e Bem-estar</option>
                    <option value="Beleza e Est√©tica">üíÖ Beleza e Est√©tica</option>
                    <option value="Alimenta√ß√£o">üçï Alimenta√ß√£o</option>
                    <option value="Educa√ß√£o">üéì Educa√ß√£o</option>
                    <option value="Constru√ß√£o Civil">üèóÔ∏è Constru√ß√£o Civil</option>
                </select>
            </div>

            <div class="form-group">
                <label><i class="fas fa-map-marker-alt"></i> Endere√ßo *</label>
                <input type="text" class="form-control" id="newLeadAddress"
                       placeholder="Ex: Rua das Flores, 123 - Centro, S√£o Jos√© dos Campos">
            </div>

            <div class="form-group">
                <label><i class="fas fa-phone"></i> Telefone *</label>
                <input type="text" class="form-control" id="newLeadContact"
                       placeholder="Ex: (12) 3456-7890">
            </div>

            <div class="form-group">
                <label><i class="fas fa-sticky-note"></i> Observa√ß√µes Iniciais</label>
                <textarea class="form-control" id="newLeadNotes"
                          placeholder="Informa√ß√µes relevantes sobre o lead, situa√ß√£o digital atual, potencial observado..."
                          rows="3"></textarea>
            </div>

            <div class="form-actions">
                <button class="btn btn-primary" onclick="addNewLead()">
                    <i class="fas fa-plus"></i>
                    <span>Cadastrar Lead</span>
                </button>

                <button class="btn btn-outline"
                        onclick="closeModal('addLeadModal')">
                    <i class="fas fa-times"></i>
                    <span>Cancelar</span>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal: IA Prospec√ß√£o -->
<div class="modal" id="iaProspectingModal">
    <div class="modal-content" style="max-width: 600px;">
        <div class="modal-header">
            <h3><i class="fas fa-robot"></i> IA de Prospec√ß√£o - Busca Inteligente</h3>
            <button class="btn btn-secondary"
                    onclick="closeModal('iaProspectingModal')">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <div class="modal-body">
            <div class="form-group">
                <label><i class="fas fa-filter"></i> Selecione o Nicho para Busca:</label>
                <select class="form-control" id="prospectingNiche">
                    <option value="Profissionais Liberais">üë®‚Äç‚öïÔ∏è Profissionais Liberais</option>
                    <option value="Servi√ßos Especializados">üîß Servi√ßos Especializados</option>
                    <option value="Com√©rcio Local">üè™ Com√©rcio Local</option>
                    <option value="Sa√∫de e Bem-estar">üí™ Sa√∫de e Bem-estar</option>
                </select>
            </div>

            <div class="form-group">
                <label><i class="fas fa-map-pin"></i> Localiza√ß√£o:</label>
                <input type="text" class="form-control" id="prospectingLocation"
                       value="S√£o Jos√© dos Campos" readonly>
            </div>

            <div class="form-group">
                <label><i class="fas fa-sliders-h"></i> Par√¢metros da Busca:</label>

                <div class="search-params">
                    <label class="checkbox-label">
                        <input type="checkbox" checked> An√°lise de Google Meu Neg√≥cio
                    </label>

                    <label class="checkbox-label">
                        <input type="checkbox" checked> Presen√ßa em Redes Sociais
                    </label>

                    <label class="checkbox-label">
                        <input type="checkbox"> Website Ativo
                    </label>

                    <label class="checkbox-label">
                        <input type="checkbox" checked> Avalia√ß√µes Online
                    </label>
                </div>
            </div>

            <button class="btn btn-primary"
                    onclick="startProspecting()"
                    id="startProspectingBtn">
                <i class="fas fa-search"></i>
                <span>Iniciar Busca IA</span>
            </button>

            <div id="prospectingResults"
                 style="display:none; margin-top:20px;">
                <h4><i class="fas fa-bullseye"></i> Leads Encontrados</h4>
                <div id="prospectingList"></div>
            </div>
        </div>
    </div>
</div>

<!-- Modal: Detalhes Lead -->
<div class="modal" id="leadDetailsModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="leadDetailsTitle">
                <i class="fas fa-user"></i>
                Detalhes do Lead
            </h3>

            <button class="btn btn-outline"
                    onclick="closeModal('leadDetailsModal')"
                    style="color:white; border-color:white;">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <div class="modal-body">
            <div class="form-group">
                <label><i class="fas fa-sticky-note"></i> Observa√ß√µes do Contato</label>
                <textarea class="form-control" id="contactNotes"
                          placeholder="Registre observa√ß√µes, andamentos, pr√≥ximos passos..."
                          rows="4"></textarea>
            </div>

            <div class="form-group">
                <label><i class="fas fa-tasks"></i> Status do Contato</label>
                <select class="form-control" id="contactStatus">
                    <option value="pending">‚è≥ Pendente</option>
                    <option value="contacted">üìû Contactado</option>
                    <option value="meeting_scheduled">üìÖ Reuni√£o Agendada</option>
                    <option value="proposal_sent">üì® Proposta Enviada</option>
                    <option value="negotiation">üíº Em Negocia√ß√£o</option>
                    <option value="closed_won">‚úÖ Fechado - Ganho</option>
                    <option value="closed_lost">‚ùå Fechado - Perdido</option>
                </select>
            </div>

            <div class="form-group">
                <label><i class="fas fa-calendar-check"></i> Pr√≥ximo Follow-up</label>
                <input type="datetime-local" class="form-control" id="nextFollowup">
            </div>

            <div class="form-actions">
                <button class="btn btn-primary" onclick="saveLeadDetails()">
                    <i class="fas fa-save"></i>
                    <span>Salvar Altera√ß√µes</span>
                </button>

                <button class="btn btn-outline"
                        onclick="closeModal('leadDetailsModal')">
                    <i class="fas fa-times"></i>
                    <span>Cancelar</span>
                </button>
            </div>

            <div class="timeline" id="timeline">
                <h4><i class="fas fa-history"></i> Hist√≥rico de Contato</h4>
                <div class="timeline-content" id="timelineContent">
                    <!-- hist√≥rico via JS -->
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ========== SCRIPTS PRINCIPAIS ========== -->
<script src="assets/js/theme.js"></script>
<script src="assets/js/ia-engine.js"></script>
<script src="assets/js/notifications.js"></script>
<script src="assets/js/main.js"></script>

<script>
/* ==== FUN√á√ïES GLOBAIS DE MODAL E L√ìGICA AUXILIAR ==== */

function openAddLeadModal() {
    document.getElementById('addLeadModal').style.display = 'flex';
    document.getElementById('newLeadName').focus();
}

function closeModal(id) {
    document.getElementById(id).style.display = 'none';
}

function closeAllModals() {
    document.querySelectorAll('.modal').forEach(m => m.style.display = 'none');
}

function calculateInitialPotential(niche, notes) {
    const nichePotential = {
        'Profissionais Liberais': 5,
        'Servi√ßos Especializados': 4,
        'Sa√∫de e Bem-estar': 4,
        'Com√©rcio Local': 3,
        'Beleza e Est√©tica': 3,
        'Alimenta√ß√£o': 3,
        'Educa√ß√£o': 4,
        'Constru√ß√£o Civil': 3
    };
    return nichePotential[niche] || 3;
}

function calculateInitialProbability(niche) {
    const baseProbabilities = {
        'Profissionais Liberais': 75,
        'Servi√ßos Especializados': 70,
        'Sa√∫de e Bem-estar': 80,
        'Com√©rcio Local': 60,
        'Beleza e Est√©tica': 65,
        'Alimenta√ß√£o': 55,
        'Educa√ß√£o': 70,
        'Constru√ß√£o Civil': 60
    };
    return baseProbabilities[niche] || 50;
}

function addNewLead() {
    const name = document.getElementById('newLeadName').value.trim();
    const niche = document.getElementById('newLeadNiche').value;
    const address = document.getElementById('newLeadAddress').value.trim();
    const contact = document.getElementById('newLeadContact').value.trim();
    const notes = document.getElementById('newLeadNotes').value.trim();

    if (!name || !niche || !address || !contact) {
        showNotification('Erro', 'Preencha todos os campos obrigat√≥rios.', 'error');
        return;
    }

    if (window.plenaSystem) {
        const newLead = {
            id: Date.now(),
            name: name.toUpperCase(),
            niche: niche,
            address: address,
            contact: contact,
            potential: calculateInitialPotential(niche, notes),
            status: 'high',
            category: niche,
            conversionProbability: calculateInitialProbability(niche),
            notes: notes,
            lastContact: 'Nunca',
            nextAction: 'Primeiro contato',
            contactHistory: [],
            contactStatus: 'pending',
            createdAt: new Date().toISOString()
        };

        window.plenaSystem.leads.unshift(newLead);
        window.plenaSystem.saveLeads();
        window.plenaSystem.loadDashboardData();

        if (window.plenaSystem.currentSection === 'leads') {
            window.plenaSystem.loadLeadsData();
        }

        closeModal('addLeadModal');
        showNotification('Sucesso', `Lead "${name}" cadastrado com sucesso!`, 'success');

        // sugest√£o IA
        if (window.iaAssistant) {
            setTimeout(() => {
                const strategy = window.iaAssistant.generateStrategy(newLead);
                showNotification(
                    'üéØ Estrat√©gia da IA',
                    `Estrat√©gia gerada para ${name}. Use o script: "${strategy.scriptLigacao.substring(0, 100)}..."`,
                    'info'
                );
            }, 1000);
        }

        // limpar form
        document.getElementById('newLeadName').value = '';
        document.getElementById('newLeadNiche').value = '';
        document.getElementById('newLeadAddress').value = '';
        document.getElementById('newLeadContact').value = '';
        document.getElementById('newLeadNotes').value = '';
    }
}

function startProspecting() {
    const niche = document.getElementById('prospectingNiche').value;
    const btn = document.getElementById('startProspectingBtn');
    const results = document.getElementById('prospectingResults');

    btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Buscando...';
    btn.disabled = true;

    setTimeout(() => {
        btn.innerHTML = '<i class="fas fa-search"></i> Busca Conclu√≠da';
        results.style.display = 'block';

        document.getElementById('prospectingList').innerHTML = `
            <div class="prospecting-result">
                <div class="result-header">
                    <h5>‚úÖ 23 leads encontrados</h5>
                    <span class="result-badge">${niche}</span>
                </div>
                <div class="result-stats">
                    <div>üìä 15 com alto potencial</div>
                    <div>üìû 8 nunca contactados</div>
                    <div>üéØ 12 sem presen√ßa digital</div>
                </div>
                <button class="btn btn-primary btn-sm" onclick="importProspectingResults()">
                    <i class="fas fa-download"></i> Importar para Sistema
                </button>
            </div>
        `;

        showNotification('IA Prospec√ß√£o', `Busca conclu√≠da: 23 leads encontrados em ${niche}`, 'success');
    }, 1500);
}

function importProspectingResults() {
    showNotification('Sistema', 'Importa√ß√£o autom√°tica vir√° na v1.1', 'info');
    closeModal('iaProspectingModal');
}

function saveLeadDetails() {
    showNotification('Sistema', 'Detalhes do lead salvos com sucesso!', 'success');
    closeModal('leadDetailsModal');
}

/* ===== Fun√ß√µes auxiliares ===== */

function showTodaysStrategy() {
    if (window.iaAssistant) {
        const strategy = window.iaAssistant.generateStrategy({
            nicho: 'Profissionais Liberais',
            name: 'Lead do Dia'
        });

        alert(`üéØ ESTRAT√âGIA DO DIA - Profissionais Liberais\n\n${strategy.scriptLigacao}\n\nüìß Email:\n${strategy.emailTemplate.substring(0,200)}...`);
    }
}

function generateQuickReport() {
    if (!window.plenaSystem) return;

    const totalLeads = window.plenaSystem.leads.length;
    const criticalLeads = window.plenaSystem.leads.filter(l => l.status === 'critical').length;
    const contactedLeads = window.plenaSystem.leads.filter(l => l.lastContact !== 'Nunca').length;
    const conversionState = window.plenaSystem.leads.filter(l =>
        l.contactStatus === 'closed_won' || l.contactStatus === 'negotiation'
    ).length;

    alert(
        `üìä RELAT√ìRIO R√ÅPIDO - ${new Date().toLocaleDateString('pt-BR')}\n\n` +
        `‚Ä¢ Total de Leads: ${totalLeads}\n` +
        `‚Ä¢ Leads Cr√≠ticos: ${criticalLeads}\n` +
        `‚Ä¢ Leads Contactados: ${contactedLeads}\n` +
        `‚Ä¢ Em Negocia√ß√£o: ${conversionState}\n` +
        `‚Ä¢ Taxa de Contato: ${
            totalLeads > 0 ? Math.round((contactedLeads / totalLeads) * 100) : 0
        }%\n\n` +
        `üí° Pr√≥ximas A√ß√µes:\n` +
        `- Focar nos ${criticalLeads} leads cr√≠ticos\n` +
        `- Contactar ${totalLeads - contactedLeads} leads pendentes\n` +
        `- Acompanhar ${conversionState} negocia√ß√µes`
    );
}

function exportLeadsData() {
    if (!window.plenaSystem || window.plenaSystem.leads.length === 0) {
        showNotification('Exporta√ß√£o', 'Nenhum lead para exportar', 'warning');
        return;
    }

    const data = {
        exportedAt: new Date().toISOString(),
        totalLeads: window.plenaSystem.leads.length,
        leads: window.plenaSystem.leads
    };

    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `leads-plena-${new Date().toISOString().split('T')[0]}.json`;
    a.click();
    URL.revokeObjectURL(url);

    showNotification('Exporta√ß√£o', 'Dados dos leads exportados com sucesso!', 'success');
}

function testNotificationSystem() {
    if (window.notificationSystem) {
        window.notificationSystem.showSuccessNotification(
            'Teste de Notifica√ß√£o',
            'Isso √© apenas um teste visual.'
        );
    }
}

/* ===== Atalhos de teclado / init ===== */
document.addEventListener('DOMContentLoaded', () => {
    console.log('üöÄ Plena Capta√ß√£o v1.0 carregado.');

    // log de sistemas
    const systems = ['plenaSystem', 'notificationSystem', 'iaAssistant'];
    const loaded = systems.filter(s => window[s]);
    console.log('‚úÖ Sistemas carregados:', loaded.join(', '));

    if (loaded.length === systems.length) {
        setTimeout(() => {
            if (window.notificationSystem) {
                window.notificationSystem.showInfoNotification(
                    'Bem-vindo ao Plena Capta√ß√£o!',
                    'Sistema carregado. Comece pelo dashboard ou cadastre seus primeiros leads.'
                );
            }
        }, 1200);
    }

    // atalhos
    document.addEventListener('keydown', e => {
        if (e.ctrlKey && e.key === 'n') {
            e.preventDefault();
            openAddLeadModal();
        }
        if (e.ctrlKey && e.key === 'f') {
            e.preventDefault();
            document.getElementById('searchInput').focus();
        }
        if (e.ctrlKey && e.key === 'r') {
            e.preventDefault();
            generateQuickReport();
        }
    });

    // service worker futuro
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/sw.js').catch(console.error);
    }
});

/* ===== Eventos globais de erro / offline ===== */
window.addEventListener('error', e => {
    console.error('Erro global:', e.error);
    if (window.notificationSystem) {
        window.notificationSystem.showErrorNotification(
            'Erro no Sistema',
            'Ocorreu um erro inesperado. Recarregue se persistir.'
        );
    }
});

window.addEventListener('online', () => {
    if (window.notificationSystem) {
        window.notificationSystem.showSuccessNotification(
            'Conex√£o Restaurada',
            'Sistema sincronizado com sucesso.'
        );
    }
});

window.addEventListener('offline', () => {
    if (window.notificationSystem) {
        window.notificationSystem.showWarningNotification(
            'Modo Offline',
            'Algumas fun√ß√µes podem estar limitadas. Seus dados locais est√£o seguros.'
        );
    }
});

/* ===== Debug Helper ===== */
window.debugSystem = function () {
    return {
        plenaSystem: window.plenaSystem,
        notificationSystem: window.notificationSystem,
        iaAssistant: window.iaAssistant,
        version: '1.0.0'
    };
};
</script>

<!-- ===== ESTILOS ESPEC√çFICOS DOS MODAIS ===== -->
<style>
.modal {
    display: none;
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.7);
    z-index: 10000;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(5px);
}

.modal-content {
    background: var(--bg-card);
    border-radius: 16px;
    box-shadow: var(--shadow-lg);
    max-width: 500px;
    width: 90%;
    max-height: 90vh;
    overflow-y: auto;
    border: 1px solid var(--border-color);
    animation: modalSlideIn 0.3s ease;
}

@keyframes modalSlideIn {
    from { opacity: 0; transform: scale(0.9) translateY(-20px); }
    to   { opacity: 1; transform: scale(1) translateY(0); }
}

.modal-header {
    padding: 25px;
    background: linear-gradient(135deg, var(--primary) 0%, #2d2d2d 100%);
    color: white;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-radius: 16px 16px 0 0;
    border-bottom: 1px solid rgba(255,255,255,0.1);
}

.modal-header h3 {
    margin: 0;
    font-size: 1.1em;
    font-weight: 600;
    line-height: 1.3;
    color: #fff;
    display: flex;
    align-items: center;
    gap: 8px;
}

.modal-body {
    padding: 25px;
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 8px;
    font-weight: 600;
    color: var(--text-primary);
    font-size: 0.9rem;
}

.form-control {
    width: 100%;
    padding: 12px 15px;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    background: var(--bg-primary);
    color: var(--text-primary);
    transition: all 0.25s ease;
    font-size: 0.95em;
    line-height: 1.3;
}

.form-control:focus {
    outline: none;
    border-color: var(--secondary);
    box-shadow: 0 0 0 3px rgba(255,107,53,0.15);
}

.form-actions {
    display: flex;
    gap: 12px;
    margin-top: 25px;
    flex-wrap: wrap;
}

.search-params {
    display: grid;
    gap: 10px;
    margin-top: 10px;
    font-size: 0.9em;
}

.checkbox-label {
    display: flex;
    align-items: center;
    gap: 8px;
    font-weight: normal;
    cursor: pointer;
    color: var(--text-secondary);
}

.checkbox-label input {
    margin: 0;
}

.prospecting-result {
    background: var(--bg-secondary);
    padding: 20px;
    border-radius: 12px;
    border: 1px solid var(--border-color);
    font-size: 0.9rem;
    line-height: 1.4;
}

.result-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    font-size: 0.95rem;
    line-height: 1.3;
    color: var(--text-primary);
    font-weight: 600;
}

.result-badge {
    background: var(--secondary);
    color: white;
    padding: 4px 8px;
    border-radius: 6px;
    font-size: 0.75em;
    font-weight: 600;
    line-height: 1.2;
}

.result-stats {
    display: grid;
    gap: 8px;
    margin-bottom: 15px;
    font-size: 0.9em;
    color: var(--text-secondary);
}

.leads-stats {
    display: flex;
    gap: 20px;
    margin: 15px 0;
    flex-wrap: wrap;
}

.stat-mini {
    text-align: center;
    padding: 10px 15px;
    background: var(--bg-secondary);
    border-radius: 8px;
    border: 1px solid var(--border-color);
    min-width: 90px;
}
.stat-number {
    display: block;
    font-size: 1.4em;
    font-weight: 700;
    color: var(--secondary);
}
.stat-label {
    font-size: 0.8em;
    color: var(--text-secondary);
}

.timeline {
    margin-top: 25px;
    padding-top: 25px;
    border-top: 1px solid var(--border-color);
}
.timeline h4 {
    margin-bottom: 15px;
    color: var(--text-primary);
    font-size: 1em;
    line-height: 1.3;
    font-weight: 600;
}

.dashboard-time {
    font-size: 0.8em;
    color: var(--text-secondary);
    margin-top: 5px;
    font-style: italic;
}

/* mobile modal tweaks */
@media (max-width: 768px) {
    .modal-content {
        width: 95%;
        margin: 20px;
    }
    .form-actions {
        flex-direction: column;
    }
}
</style>

</body>
</html>